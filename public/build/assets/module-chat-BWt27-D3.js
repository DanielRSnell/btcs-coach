import{r as c,b as q,j as e,H as F,L as R,c as Y}from"./app-B88byb-o.js";import{A as Z}from"./app-layout-DTCIQElM.js";import{a as g,B as x}from"./app-logo-icon-C_DDbJKP.js";import{C as m,a as p,c as h,b as j,d as E,B as n}from"./badge-CgsWBpbi.js";import{T as K,a as G,b as I,c as M}from"./tabs-BmVWmJ-x.js";import{D as Q,a as W,b as X,c as ee,d as se,e as te}from"./dialog-OgiQYube.js";import{C as V}from"./clock-kGghZehJ.js";import{T as w}from"./target-DgFNcOCH.js";import{B as L}from"./book-open-BMunbtsT.js";import{m as ae}from"./proxy-CBuNY2B5.js";import{C as ie}from"./circle-check-big-D29YrtMM.js";/* empty css            */import"./index-CEUdVq09.js";import"./index-BGuDyg4b.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],ce=g("ArrowLeft",le);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],re=g("CircleAlert",ne);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],de=g("Circle",oe);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]],me=g("MessageCircle",xe);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],he=g("Mic",pe),ge={coaching:"bg-green-100 text-green-800",training:"bg-yellow-100 text-yellow-800",assessment:"bg-blue-100 text-blue-800"},fe={beginner:"bg-emerald-100 text-emerald-800",intermediate:"bg-amber-100 text-amber-800",advanced:"bg-red-100 text-red-800"},B={low:"bg-blue-100 text-blue-800",medium:"bg-yellow-100 text-yellow-800",high:"bg-red-100 text-red-800"},O=s=>{switch(s){case"completed":return e.jsx(ie,{className:"h-4 w-4 text-green-500"});case"in_progress":return e.jsx(re,{className:"h-4 w-4 text-yellow-500"});default:return e.jsx(de,{className:"h-4 w-4 text-gray-400"})}};function Ee({module:s,user:t,actionItems:_=[]}){const[i,v]=c.useState(null),[z,f]=c.useState(!1),[C,r]=c.useState(!1),[o,k]=c.useState("voiceflow"),$=c.useRef(null),{props:H}=q(),y=H.flash?.success;c.useEffect(()=>{y&&console.log("Success:",y)},[y]);const P=a=>{v(a),f(!0)},J=()=>{f(!1),v(null),r(!1)},U=()=>{i&&(r(!0),Y.put(`/action-items/${i.id}/complete`,{},{preserveState:!1,preserveScroll:!0,onSuccess:a=>{f(!1),v(null),r(!1),console.log("Action item marked as completed successfully")},onError:a=>{console.error("Failed to update action item:",a),alert("Failed to update action item. Please try again."),r(!1)},onFinish:()=>{r(!1)}}))};c.useEffect(()=>{if(!document.querySelector('script[src*="convai-widget-embed"]')){const a=document.createElement("script");a.src="https://unpkg.com/@elevenlabs/convai-widget-embed",a.async=!0,a.type="text/javascript",document.head.appendChild(a)}},[]);const b={user_profile:JSON.stringify({id:t?.id||0,name:t?.name||"Anonymous",email:t?.email||"",role:t?.role||"member",pi_behavioral_pattern_id:t?.pi_behavioral_pattern_id||null,pi_behavioral_pattern:t?.pi_behavioral_pattern||null,pi_raw_scores:t?.pi_raw_scores||null,pi_assessed_at:t?.pi_assessed_at||null,pi_notes:t?.pi_notes||null,pi_profile:t?.pi_profile||null,has_pi_assessment:t?.has_pi_assessment||!1,has_pi_profile:t?.has_pi_profile||!1}),module_context:JSON.stringify({route:{name:"modules.chat",path:`/modules/${s.slug}/chat`,params:{slug:s.slug}},module:{id:s.id,title:s.title,description:s.description,goal:s.goal,type:s.type,slug:s.slug,topics:s.topics,topics_string:s.topics.join(", "),sample_questions:s.sample_questions,learning_objectives:s.learning_objectives,expected_outcomes:s.expected_outcomes,estimated_duration:s.estimated_duration,difficulty:s.difficulty}}),user_name:t?.name?t.name.split(" ")[0]:"Anonymous",module:s.title};return console.log("ðŸš€ ElevenLabs Variables Structure:",b),console.log("ðŸš€ ElevenLabs Final JSON:",JSON.stringify(b)),c.useEffect(()=>{const a=()=>{setTimeout(()=>{console.log("Starting Voiceflow initialization...");const N=document.getElementById("btcs-chat");console.log("Chat element found:",N),function(S,D){const d=S.createElement(D),T=S.getElementsByTagName(D)[0];d.onload=function(){if(console.log("Voiceflow script loaded, window.voiceflow:",window.voiceflow),window.voiceflow&&window.voiceflow.chat){const l=document.getElementById("btcs-chat");console.log("Target element for Voiceflow:",l);const A={route:{name:"modules.chat",path:`/modules/${s.slug}/chat`,params:{slug:s.slug}},module:{id:s.id,title:s.title,description:s.description,goal:s.goal,type:s.type,slug:s.slug,topics:s.topics,topics_string:s.topics.join(", "),sample_questions:s.sample_questions,learning_objectives:s.learning_objectives,expected_outcomes:s.expected_outcomes,estimated_duration:s.estimated_duration,difficulty:s.difficulty},user:{id:t?.id||0,name:t?.name||"Anonymous",email:t?.email||"",role:t?.role||"member",pi_behavioral_pattern_id:t?.pi_behavioral_pattern_id||null,pi_behavioral_pattern:t?.pi_behavioral_pattern||null,pi_raw_scores:t?.pi_raw_scores||null,pi_assessed_at:t?.pi_assessed_at||null,pi_notes:t?.pi_notes||null,pi_profile:t?.pi_profile||null,has_pi_assessment:t?.has_pi_assessment||!1,has_pi_profile:t?.has_pi_profile||!1},session_context:"pi_ssl_coaching"};console.log("ðŸš€ Voiceflow Payload:",JSON.stringify(A,null,2)),window.voiceflow.chat.load({verify:{projectID:"686331bc96acfa1dd62f6fd5"},url:"https://general-runtime.voiceflow.com",versionID:"production",voice:{url:"https://runtime-api.voiceflow.com"},render:{mode:"embedded",target:l},assistant:{stylesheet:"/voiceflow.css?v="+new Date().toISOString().replace(/[:.]/g,"-"),persistence:"memory"},autostart:!0,launch:{event:{type:"launch",payload:A}}}),console.log("Voiceflow chat loaded for module:",s.title)}else{console.error("Voiceflow widget failed to load - missing window.voiceflow");const l=document.getElementById("btcs-chat");l&&(l.innerHTML=`
                                    <div class="flex items-center justify-center h-full text-gray-500">
                                        <div class="text-center">
                                            <p class="text-lg font-medium text-red-600 mb-2">Chat Temporarily Unavailable</p>
                                            <p class="text-sm">Please refresh the page or try again later.</p>
                                            <p class="text-xs mt-2 text-gray-400">Error: Voiceflow widget failed to initialize</p>
                                        </div>
                                    </div>
                                `)}},d.onerror=function(){console.error("Failed to load Voiceflow script from CDN");const l=document.getElementById("btcs-chat");l&&(l.innerHTML=`
                                <div class="flex items-center justify-center h-full text-gray-500">
                                    <div class="text-center">
                                        <p class="text-lg font-medium text-red-600 mb-2">Chat Service Unavailable</p>
                                        <p class="text-sm">Unable to connect to chat service.</p>
                                        <p class="text-xs mt-2 text-gray-400">Please contact support if this issue persists.</p>
                                    </div>
                                </div>
                            `)},d.src="https://cdn.voiceflow.com/widget-next/bundle.mjs",d.type="text/javascript",console.log("Adding Voiceflow script to DOM..."),T.parentNode?.insertBefore(d,T)}(document,"script")},100),console.log("Voiceflow initialization started for module:",s.title)},u=()=>{if(window.voiceflow&&window.voiceflow.chat)try{window.voiceflow.chat.destroy(),console.log("Voiceflow chat destroyed")}catch(N){console.warn("Error cleaning up Voiceflow:",N)}};return u(),a(),u},[s,t]),e.jsxs(Z,{children:[e.jsx(F,{title:`${s.title} - Interactive Session`}),e.jsxs("div",{className:"flex gap-6",style:{height:"calc(100vh - 200px)"},children:[e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx(R,{href:"/modules",children:e.jsxs(x,{variant:"outline",size:"sm",children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Back to Modules"]})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:s.title}),e.jsx("p",{className:"text-sm text-gray-600",children:"Interactive Coaching Session"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(x,{variant:"outline",size:"sm",children:"Save Progress"}),e.jsx(x,{variant:"outline",size:"sm",children:"End Session"})]})]}),e.jsxs(m,{className:"flex-1 flex flex-col py-0",style:{minHeight:"500px",maxHeight:"calc(100vh - 280px)"},children:[e.jsx(p,{className:"py-3 px-4 border-b",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("button",{onClick:()=>k("voiceflow"),className:`inline-flex items-center gap-2 px-3 py-2 text-sm font-medium rounded-lg transition-colors ${o==="voiceflow"?"bg-blue-100 text-blue-700 border-blue-200 border":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:[e.jsx(me,{className:"h-4 w-4"}),"Text Chat"]}),e.jsxs("button",{onClick:()=>k("elevenlabs"),className:`inline-flex items-center gap-2 px-3 py-2 text-sm font-medium rounded-lg transition-colors ${o==="elevenlabs"?"bg-green-100 text-green-700 border-green-200 border":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:[e.jsx(he,{className:"h-4 w-4"}),"Voice Chat"]})]}),e.jsx("div",{className:"text-sm text-gray-500 ml-auto",children:o==="voiceflow"?"Text-based coaching conversation":"Voice-based AI coaching"})]})}),e.jsxs(h,{className:"p-0 flex-1 relative",children:[e.jsx("div",{id:"btcs-chat",className:`w-full h-full ${o==="voiceflow"?"block":"hidden"}`,style:{maxHeight:"calc(100vh - 200px)"},children:e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-pulse",children:e.jsx("div",{className:"w-8 h-8 bg-blue-200 rounded-full mx-auto mb-4"})}),e.jsx("p",{children:"Initializing your coaching session..."}),e.jsx("p",{className:"text-sm mt-2",children:"Your AI coach will appear here shortly."})]})})}),o==="elevenlabs"&&e.jsx("div",{className:"w-full h-full",children:e.jsx("div",{className:"w-full h-full relative",children:e.jsx("elevenlabs-convai",{ref:$,"agent-id":"agent_0901k31ke64mf0w8me1gdwygb7ze","dynamic-variables":JSON.stringify(b),style:{position:"relative",width:"100%",height:"100%",display:"block"}})})})]})]})]}),e.jsx("div",{className:"w-80",children:e.jsxs(K,{defaultValue:"info",className:"w-full",children:[e.jsxs(G,{className:"grid w-full grid-cols-2",children:[e.jsx(I,{value:"info",children:"Info"}),e.jsx(I,{value:"actions",children:"Actions"})]}),e.jsxs(M,{value:"info",className:"space-y-4 mt-4",children:[e.jsxs(m,{children:[e.jsxs(p,{className:"pb-3",children:[e.jsx(j,{className:"text-lg",children:s.title}),e.jsx(E,{className:"text-sm",children:s.description})]}),e.jsxs(h,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{className:ge[s.type],children:s.type}),e.jsx(n,{variant:"outline",className:fe[s.difficulty],children:s.difficulty})]}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-500",children:[e.jsx(V,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.estimated_duration," minutes"]})]})]})]}),e.jsxs(m,{children:[e.jsx(p,{className:"pb-3",children:e.jsxs(j,{className:"flex items-center gap-2 text-lg",children:[e.jsx(w,{className:"h-5 w-5"}),"Session Overview"]})}),e.jsxs(h,{className:"space-y-4",children:[s.topics&&s.topics.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(L,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Key Topics:"})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.topics.map((a,u)=>e.jsx(n,{variant:"secondary",className:"text-xs",children:a},u))})]}),s.learning_objectives&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(w,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Learning Objectives:"})]}),e.jsx("p",{className:"text-sm text-gray-600 leading-relaxed",children:s.learning_objectives})]})]})]}),e.jsxs(m,{children:[e.jsx(p,{className:"pb-3",children:e.jsx(j,{className:"text-lg",children:"Session Progress"})}),e.jsx(h,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Status"}),e.jsx("span",{className:"font-medium text-green-600",children:"In Progress"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Started"}),e.jsx("span",{className:"font-medium",children:"Just now"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Estimated Time"}),e.jsxs("span",{className:"font-medium",children:[s.estimated_duration," min"]})]})]})})]})]}),e.jsx(M,{value:"actions",className:"space-y-4 mt-4",children:e.jsxs(m,{children:[e.jsxs(p,{className:"pb-3",children:[e.jsx(j,{className:"text-lg",children:"Module Action Items"}),e.jsxs(E,{className:"text-sm",children:["Your personalized tasks and objectives for ",s.title]})]}),e.jsx(h,{children:_.length===0?e.jsxs("div",{className:"text-center py-6 text-gray-500",children:[e.jsx(w,{className:"h-8 w-8 mx-auto mb-2 text-gray-300"}),e.jsx("p",{className:"text-sm",children:"No action items for this module yet"}),e.jsx("p",{className:"text-xs mt-1",children:"Complete coaching sessions to generate personalized tasks"})]}):e.jsx("div",{className:"space-y-3",children:_.map(a=>e.jsxs(ae.div,{className:"border rounded-lg p-3 space-y-2 cursor-pointer hover:bg-gray-50 transition-colors",onClick:()=>P(a),whileHover:{scale:1.01},whileTap:{scale:.99},children:[e.jsxs("div",{className:"flex items-start gap-2",children:[O(a.status),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 truncate",children:a.title}),e.jsx("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:a.description})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{variant:"outline",className:`text-xs ${B[a.priority]}`,children:a.priority}),a.due_date&&e.jsxs("span",{className:"text-xs text-gray-500",children:["Due ",new Date(a.due_date).toLocaleDateString()]})]}),a.context&&e.jsx("div",{className:"text-xs text-gray-500 italic truncate",children:a.context})]},a.id))})})]})})]})})]}),e.jsx(Q,{open:z,onOpenChange:f,children:e.jsxs(W,{className:"max-w-2xl",children:[e.jsxs(X,{children:[e.jsxs(ee,{className:"flex items-center gap-2",children:[i&&O(i.status),i?.title]}),e.jsx(se,{children:"Action item details and progress tracking"})]}),i&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Status:"}),e.jsx(n,{variant:i.status==="completed"?"default":"secondary",children:i.status.replace("_"," ")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Priority:"}),e.jsx(n,{variant:"outline",className:B[i.priority],children:i.priority})]})]}),i.due_date&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-sm text-gray-700",children:["Due: ",new Date(i.due_date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Description"}),e.jsx("p",{className:"text-sm text-gray-700 leading-relaxed",children:i.description})]}),i.context&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Context"}),e.jsx("p",{className:"text-sm text-gray-600 italic",children:i.context})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(L,{className:"h-4 w-4 text-blue-600"}),e.jsx("h4",{className:"text-sm font-medium text-blue-900",children:"Related Module"})]}),e.jsx("p",{className:"text-sm text-blue-800",children:s.title}),e.jsx("p",{className:"text-xs text-blue-600 mt-1",children:s.description})]})]}),e.jsxs(te,{children:[e.jsx(x,{variant:"outline",onClick:J,children:"Close"}),i?.status!=="completed"&&e.jsx(x,{onClick:U,disabled:C,children:C?"Updating...":"Mark as Completed"})]})]})})]})}export{Ee as default};
