import{j as e,u as se,r as g,H as te,a as U}from"./app-CHErqvc6.js";import{A as ne,M as y,D as le,a as ae,b as re,c as ce,d as ie,e as de}from"./app-layout-CD4riDtw.js";import{C as P,a as ge,b as he,d as ue,c as G}from"./card-Drk4hI3b.js";import{c as _,a as fe,B as w}from"./app-logo-icon-B0h-Ut6k.js";import{C as me}from"./clock-DWMNTkQm.js";import{M as pe}from"./mic-DrlHyPT1.js";/* empty css            */import"./index-CR-cSDcI.js";import"./label-CaCr2IvL.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Se=_("Calendar",we);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]],M=_("ThumbsDown",xe);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]],K=_("ThumbsUp",ve);function ye({className:i,...d}){return e.jsx("textarea",{"data-slot":"textarea",className:fe("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",i),...d})}function Ae({user:i,sessions:d,currentSessionId:D,currentSession:b,newSessionName:I,newSessionStatus:H,isAudioMode:u}){console.log("ğŸ” Sessions component loaded with data:"),console.log("ğŸ‘¤ User received:",i?.name,i?.id),console.log("ğŸ“Š Sessions received:",d),console.log("ğŸ“Š Sessions type:",typeof d),console.log("ğŸ“Š Sessions keys:",d?Object.keys(d):"sessions is null/undefined"),console.log("ğŸ“Š Sessions count:",d?Object.keys(d).length:0),console.log("ğŸ¯ Current Session ID received:",D),console.log("ğŸ¯ Current Session data received:",b),console.log("ğŸ†• New Session Name received:",I),console.log("ğŸ†• New Session Status received:",H),console.log("ğŸµ Audio mode received from server:",u);const{props:be}=se(),[J,z]=g.useState(null),[T,B]=g.useState(!1),[h,N]=g.useState(null),[Ne,q]=g.useState(!1),[f,Y]=g.useState(I||null),[X,x]=g.useState(!1),[m,j]=g.useState(null),[C,O]=g.useState(""),[k,A]=g.useState(!1),Z=g.useRef(null);g.useCallback(o=>{o&&u&&console.log("ğŸ¯ ElevenLabs container element mounted")},[u]);const L=()=>{console.log("ğŸ”„ External refresh requested - reloading sessions data..."),console.log("ğŸ”„ Current sessions before reload:",d),console.log("ğŸ”„ Sessions count before reload:",Object.keys(d).length),U.reload({only:["sessions"],onSuccess:o=>{console.log("âœ… Reload successful - new page data:",o),console.log("âœ… New sessions data:",o.props.sessions),console.log("âœ… New sessions count:",Object.keys(o.props.sessions||{}).length)},onError:o=>{console.error("âŒ Reload failed:",o)}})};g.useEffect(()=>(window.refreshSessionsList=L,console.log("âœ… Global function window.refreshSessionsList() is now available"),()=>{delete window.refreshSessionsList,console.log("ğŸ§¹ Cleaned up window.refreshSessionsList()")}),[L]),g.useEffect(()=>{if(!document.querySelector('script[src*="widget-next/bundle.mjs"]')){const o=document.createElement("script");o.src="https://cdn.voiceflow.com/widget-next/bundle.mjs",o.async=!0,o.type="text/javascript",document.head.appendChild(o)}},[]);const Q=()=>{console.log("ğŸ”„ INITIALIZING VOICEFLOW: Starting initialization..."),setTimeout(()=>{console.log("ğŸ¯ DOM READY: Starting Voiceflow initialization...");const o=document.getElementById("main-voiceflow-chat");console.log("ğŸ“ Chat element found:",o),window.voiceflow&&window.voiceflow.chat?(console.log("âœ… VOICEFLOW AVAILABLE: Using existing Voiceflow instance"),R()):(console.log("ğŸš€ LOADING VOICEFLOW: Loading Voiceflow script..."),function(t,l){const n=t.createElement(l),s=t.getElementsByTagName(l)[0];n.onload=function(){console.log("ğŸ“¦ SCRIPT LOADED: Voiceflow script loaded, window.voiceflow:",window.voiceflow),R()},n.src="https://cdn.voiceflow.com/widget-next/bundle.mjs",n.type="text/javascript",s.parentNode?.insertBefore(n,s)}(document,"script"))},100)},R=()=>{if(console.log("âš¡ LOADING CHAT: Configuring Voiceflow chat..."),window.voiceflow&&window.voiceflow.chat){const o=document.getElementById("main-voiceflow-chat");console.log("ğŸ¯ Target element for Voiceflow:",o);const t=window.ChatInfo?.payload||{},l=window.ChatInfo?.name||"";console.log("ğŸš€ Voiceflow User Payload:",JSON.stringify(t,null,2)),console.log("ğŸš€ Voiceflow Chat Name:",l),window.voiceflow.chat.load({verify:{projectID:"686331bc96acfa1dd62f6fd5"},url:"https://general-runtime.voiceflow.com",versionID:"production",assistant:{type:"chat",banner:{title:l},extensions:[window.AdaptiveCardExtension],stylesheet:"/voiceflow.css?v="+new Date().toISOString().replace(/[:.]/g,"-"),inputPlaceholder:"What's my PI Profile?"},render:{mode:"embedded",target:o},autostart:!0,launch:{event:{type:"launch",payload:t}}}),console.log("âœ… CHAT LOADED: Voiceflow chat loaded successfully"),q(!0);let n=0;const s=10,a=()=>{n++;const r=Object.keys(localStorage).filter(c=>c.startsWith("voiceflow-session-"));console.log(`ğŸ”„ POST-VOICEFLOW SCAN (attempt ${n}): Found ${r.length} localStorage sessions`),r.length>0?(console.log("âœ… New localStorage sessions detected, running scan..."),console.log("ğŸ¯ Pending session name for registration:",f),console.log("ğŸ¯ New session name from props:",I),$()):n<s?setTimeout(a,500):console.log("â° Max attempts reached, no new sessions found after Voiceflow load")};setTimeout(a,1e3),f&&(console.log("ğŸ¯ NEW SESSION FLOW: Detected pendingSessionName, setting up direct registration..."),setTimeout(()=>{console.log("ğŸ¯ NEW SESSION FLOW: Attempting direct registration for new session...");const r=Object.keys(localStorage).filter(c=>c.startsWith("voiceflow-session-"));r.length>0?(console.log("ğŸ¯ NEW SESSION FLOW: Found localStorage entries, processing..."),r.forEach(async c=>{const p=localStorage.getItem(c);p&&(console.log(`ğŸ¯ NEW SESSION FLOW: Processing ${c} with pending name "${f}"`),await v(c,p))})):console.log("ğŸ¯ NEW SESSION FLOW: No localStorage entries found yet")},2e3))}else{console.error("âŒ VOICEFLOW MISSING: Voiceflow widget failed to load - missing window.voiceflow");const o=document.getElementById("main-voiceflow-chat");o&&(o.innerHTML=`
                    <div class="flex items-center justify-center h-96 bg-gray-50 rounded-lg">
                        <div class="text-center">
                            <div class="text-gray-500 mb-2">Chat widget failed to load</div>
                            <button onclick="location.reload()" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">
                                Retry
                            </button>
                        </div>
                    </div>
                `)}};g.useEffect(()=>{let o=[];try{const s=Object.keys(localStorage).filter(a=>a.includes("cmeu"));if(console.log('ğŸ” Checking for localStorage keys containing "cmeu":',s),s.length>0){const a=s[0],r=localStorage.getItem(a);if(r){console.log(`ğŸ“¦ Found cmeu data in key "${a}"`);const c=JSON.parse(r);c.turns&&Array.isArray(c.turns)?(o=c.turns,console.log(`âœ… Extracted ${o.length} turns from cmeu localStorage:`,o)):console.log("âš ï¸ No turns array found in cmeu data")}else console.log(`âš ï¸ No data found for cmeu key "${a}"`)}else console.log('ğŸ“­ No localStorage keys containing "cmeu" found')}catch(n){console.error("âŒ Error extracting voicechat_history from localStorage:",n)}const t={id:i?.id||0,name:i?.name||"Anonymous",email:i?.email||"",role:i?.role||"member",employee_number:i?.employee_number||null,org_level_2:i?.org_level_2||null,job:i?.job||null,job_code:i?.job_code||null,employment_status:i?.employment_status||null,team_members:i?.team_members||[],pi_behavioral_pattern_id:i?.pi_behavioral_pattern_id||null,pi_behavioral_pattern:i?.pi_behavioral_pattern||null,pi_raw_scores:i?.pi_raw_scores||null,pi_assessed_at:i?.pi_assessed_at||null,pi_notes:i?.pi_notes||null,pi_profile:i?.pi_profile||null,has_pi_assessment:i?.has_pi_assessment||!1,has_pi_profile:i?.has_pi_profile||!1,voicechat_history:o},l=b?.name||f||"";if(window.ChatInfo={name:l,payload:t},console.log("âœ… window.ChatInfo created for",u?"AUDIO":"TEXT","mode:",window.ChatInfo),u){const n=window.ChatInfo?.payload||{};let s={};const a=Object.keys(localStorage).filter(r=>r.startsWith("voiceflow-session-"));if(a.length>0){const r=localStorage.getItem(a[0]);if(r)try{s=JSON.parse(r)}catch(c){console.warn("Failed to parse voiceflow localStorage:",c)}}window.chatContext={...n,...s},console.log("âœ… window.chatContext created:",window.chatContext)}u?console.log("ğŸµ AUDIO MODE: Scripts will be loaded via PHP footer"):(console.log("ğŸ”„ COMPONENT MOUNT: Initializing Voiceflow..."),console.log("ğŸ‘¤ User:",i?.name,i?.id),console.log("ğŸ“ Current Session ID:",D),Q())},[i,u]);const E=async(o,t)=>{try{console.log(`ğŸ“¡ Making API call to ${o} with data:`,t);const l=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify(t)});console.log(`ğŸ“¡ Response status: ${l.status} ${l.statusText}`),console.log("ğŸ“¡ Response headers:",Object.fromEntries(l.headers.entries()));const n=await l.text();console.log("ğŸ“¡ Raw response:",n.substring(0,200)+(n.length>200?"...":""));let s;try{s=JSON.parse(n),console.log("ğŸ“¡ Parsed JSON result:",s)}catch(a){return console.error("âŒ Failed to parse response as JSON:",a),console.log("âŒ Response was:",n),{error:"Invalid JSON response",raw_response:n}}return s.error==="Unauthenticated"&&console.warn(`ğŸ”’ Authentication required for ${o}. User may need to log in again.`),s}catch(l){return console.error(`âŒ API call to ${o} failed:`,l),{error:"Network error",details:l}}},S=()=>{try{const o=Object.keys(localStorage).filter(t=>t.startsWith("voiceflow-session-"));if(o.length===0){N(null);return}for(const t of o){const l=localStorage.getItem(t);if(l)try{const s=JSON.parse(l).userID;if(s&&d[s]){N(s),console.log(`ğŸ¯ Current active session identified: ${s} from localStorage key: ${t}`);return}}catch(n){console.warn(`âš ï¸ Could not parse localStorage session ${t}:`,n);continue}}N(null)}catch(o){console.error("âŒ Error identifying current active session:",o),N(null)}},v=async(o,t)=>{const l=o.replace("voiceflow-session-","");try{console.log(`ğŸ” Monitoring localStorage key: ${o}`),console.log("ğŸ“¦ Raw localStorage value:",t.substring(0,200)+"...");let n;try{n=JSON.parse(t)}catch(r){console.error(`âŒ Failed to parse localStorage JSON for ${o}:`,r);return}const s=n.userID;if(console.log("ğŸ¯ Session Analysis:",{localStorage_key:o,project_id:l,session_userID:s,status:n.status,turns_count:n.turns?.length||0}),!s){console.warn("âš ï¸ No userID found in localStorage value. Available keys:",Object.keys(n)),console.warn("âš ï¸ Cannot process session without userID - skipping");return}console.log(`ğŸ” ğŸ” CHECKING: Does session with userID "${s}" exist in database?`);const a=await E("/api/sessions/check",{project_id:l,voiceflow_user_id:s});if(a&&a.error){a.error==="Unauthenticated"?console.warn(`ğŸ”’ âŒ CANNOT CHECK: User not authenticated - skipping session "${s}"`):a.error==="Invalid JSON response"?console.error("ğŸš¨ âŒ API ERROR: Returning HTML instead of JSON - check routes/middleware"):console.error(`âŒ API ERROR: Failed to check session "${s}":`,a.error);return}if(a&&a.exists){console.log(`âœ… âœ… SESSION EXISTS: Found userID "${s}" in database`),console.log("ğŸ”„ ğŸ”„ UPDATING: Syncing current localStorage value to existing session...");const r=await E("/api/sessions/update",{project_id:l,session_data:{last_turn:n,source:"localStorage_sync"}});r?.success?(console.log(`âœ… âœ… UPDATE SUCCESS: Session "${s}" updated with latest localStorage data`),console.log(`ğŸ“Š Updated session now has ${n.turns?.length||0} messages`)):r?.error&&console.error(`âŒ âŒ UPDATE FAILED: Could not update session "${s}":`,r.error)}else{console.log(`ğŸ†• ğŸ†• NEW SESSION DETECTED: userID "${s}" NOT found in database`),console.log("ğŸ“ ğŸ“ REGISTERING: Creating new session record..."),console.log(`ğŸ¯ Using pending session name: "${f}"`),console.log(`ğŸ¯ Registration triggered from: ${new Error().stack?.split(`
`)[1]?.trim()}`);const r={project_id:l,session_data:{last_turn:n,source:"localStorage_sync",detected_at:new Date().toISOString()},session_name:f};console.log("ğŸ“‹ Registration details:",{project_id:l,userID:s,status:n.status,message_count:n.turns?.length||0});const c=await E("/api/sessions/register",r);c?.success?(console.log(`âœ… âœ… REGISTRATION SUCCESS: New session "${s}" created in database`),console.log("ğŸ‰ ğŸ‰ NEW SESSION ADDED: Refreshing sidebar to show the new session..."),console.log("ğŸ“Š Registered session data:",c),Y(null),console.log("ğŸ”„ Triggering sessions list refresh..."),U.reload({only:["sessions"],onSuccess:()=>{console.log("âœ… Sessions list refreshed successfully")},onError:p=>{console.error("âŒ Failed to refresh sessions list:",p)}})):c?.error&&(console.error(`âŒ âŒ REGISTRATION FAILED: Could not create session "${s}":`,c.error),console.error("âŒ Full error details:",c))}console.log(`ğŸ ğŸ SYNC COMPLETE: Finished processing session "${s}"`),console.log("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€")}catch(n){console.error("âŒ Error processing localStorage session:",n)}},$=async()=>{console.log("ğŸ” ğŸš€ ğŸš€ STARTING INITIAL LOCALSTORAGE SCAN..."),console.log("ğŸ” Scanning for keys matching pattern: voiceflow-session-*");const o=Object.keys(localStorage).filter(t=>t.startsWith("voiceflow-session-"));console.log(`ğŸ“¦ ğŸ“¦ FOUND ${o.length} VOICEFLOW SESSION KEYS:`),o.forEach((t,l)=>{console.log(`  ${l+1}. ${t}`)}),o.length===0?console.log("ğŸ“­ No Voiceflow sessions found in localStorage - monitoring for new ones..."):console.log("ğŸ”„ ğŸ”„ PROCESSING EACH SESSION: Checking database and syncing...");for(let t=0;t<o.length;t++){const l=o[t],n=localStorage.getItem(l);console.log(`
ğŸ”„ [${t+1}/${o.length}] PROCESSING: ${l}`),n?await v(l,n):console.warn(`âš ï¸ âš ï¸ WARNING: Key ${l} has no value - skipping`)}console.log(`
âœ… âœ… INITIAL SCAN COMPLETE: Processed ${o.length} sessions`),console.log("ğŸ§ ğŸ§ MONITORING ACTIVE: Watching for localStorage changes..."),console.log("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")};g.useEffect(()=>{$()},[]),g.useEffect(()=>{d&&Object.keys(d).length>0&&S()},[d]),g.useEffect(()=>{if(T)return;console.log("ğŸ§ Setting up CONTINUOUS localStorage monitoring...");const o=async s=>{s.key?.startsWith("voiceflow-session-")&&(console.log("ğŸ”„ ğŸ”„ LOCALSTORAGE CHANGE DETECTED!"),console.log(`ğŸ“ Key: ${s.key}`),console.log(`ğŸ“¦ New value length: ${s.newValue?.length||0} characters`),console.log("ğŸš€ ğŸš€ TRIGGERING SYNC: Processing localStorage change..."),s.newValue?(console.log(`ğŸ“‹ PROCESSING: localStorage change for ${s.key}`),await v(s.key,s.newValue),S()):(console.log(`ğŸ—‘ï¸ VALUE REMOVED: localStorage key ${s.key} was deleted (not processing)`),S()))};window.addEventListener("storage",o);const t=localStorage.setItem;localStorage.setItem=function(s,a){const r=new CustomEvent("localStorageChange",{detail:{key:s,newValue:a,oldValue:localStorage.getItem(s)}});t.apply(this,[s,a]),window.dispatchEvent(r)};const l=s=>{const{key:a,newValue:r}=s.detail;a?.startsWith("voiceflow-session-")&&(r&&v(a,r),S())};window.addEventListener("localStorageChange",l);const n=setInterval(()=>{console.log("ğŸ” Polling for new localStorage sessions..."),Object.keys(localStorage).filter(a=>a.startsWith("voiceflow-session-")).forEach(a=>{const r=localStorage.getItem(a);if(r)try{const p=JSON.parse(r).userID;p&&!d[p]&&(console.log(`ğŸ†• NEW SESSION DETECTED via polling: ${a} with userID: ${p}`),v(a,r),S())}catch(c){console.warn(`âš ï¸ Could not parse session during polling: ${a}`,c)}})},2e3);return B(!0),console.log("âœ… localStorage listeners and polling set up successfully"),()=>{window.removeEventListener("storage",o),window.removeEventListener("localStorageChange",l),clearInterval(n),localStorage.setItem=t}},[T]),g.useEffect(()=>(console.log("ğŸ—³ï¸ Setting up window.chatActions..."),window.chatActions={upVote:o=>{console.log("ğŸ‘ Message upvoted:",o.substring(0,100)+"...")},downVote:o=>{console.log("ğŸ‘ Message downvoted:",o.substring(0,100)+"...")}},console.log("âœ… window.chatActions set up successfully"),()=>{delete window.chatActions}),[]);const V=o=>{try{return new Date(o).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})}catch{return"Unknown"}},ee=(o,t)=>{console.log(`ğŸ”„ SWITCHING TO SESSION: ${o}`),console.log("ğŸ“Š Session data:",t);try{console.log("ğŸ§¹ CLEARING: Removing all voiceflow-session-* from localStorage"),Object.keys(localStorage).filter(c=>c.startsWith("voiceflow-session-")).forEach(c=>{console.log(`ğŸ—‘ï¸ Removing: ${c}`),localStorage.removeItem(c)});const s=`voiceflow-session-${t.project_id||"686331bc96acfa1dd62f6fd5"}`,a=t.value||{};console.log(`ğŸ“ CREATING: New localStorage entry ${s}`),console.log("ğŸ“¦ Session value data:",a),localStorage.setItem(s,JSON.stringify(a)),z(o);const r=`/sessions/${o}`;console.log(`ğŸ§­ NAVIGATING: To ${r} (full page reload)`),window.location.href=r}catch(l){console.error("âŒ Error switching sessions:",l)}},oe=async()=>{if(!m||!h){console.error("Missing feedback rating or active session ID");return}A(!0);try{console.log("ğŸ“ Submitting feedback",{session_id:h,rating:m,comment:C});const o=await E("/api/sessions/feedback",{session_id:h,rating:m,comment:C.trim()||null});o?.success?(console.log("âœ… Feedback submitted successfully"),x(!1),j(null),O(""),alert("Thank you for your feedback!")):(console.error("âŒ Feedback submission failed:",o),alert("Failed to submit feedback. Please try again."))}catch(o){console.error("âŒ Error submitting feedback:",o),alert("An error occurred while submitting feedback.")}finally{A(!1)}},F=()=>{if(!h){console.warn("No active session to provide feedback for");return}console.log("ğŸ‘ Thumbs up clicked for session:",h),j("positive"),x(!0)},W=()=>{if(!h){console.warn("No active session to provide feedback for");return}console.log("ğŸ‘ Thumbs down clicked for session:",h),j("negative"),x(!0)};return e.jsxs(ne,{children:[e.jsx(te,{title:"Sessions",children:e.jsx("script",{src:"/localStorage.js",defer:!0})}),e.jsxs("div",{className:"flex h-[calc(100vh-8rem)] gap-6 pt-6",children:[e.jsx("div",{className:"w-80 flex-shrink-0",children:e.jsxs(P,{className:"h-full flex flex-col gap-1 py-0 pt-6",children:[e.jsxs(ge,{className:"flex-shrink-0",children:[e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(y,{className:"h-5 w-5"}),"Your Sessions"]}),e.jsxs(ue,{children:[Object.keys(d).length," active session",Object.keys(d).length!==1?"s":""]})]}),e.jsx(G,{className:"p-0 flex-1 flex flex-col min-h-0",children:e.jsx("div",{className:"flex-1 overflow-y-auto no-scrollbar",children:Object.keys(d).length===0?e.jsx("div",{className:"h-full flex flex-col items-center justify-center p-6 text-center",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx("div",{className:"p-6 bg-gray-50 rounded-full",children:e.jsx(y,{className:"h-10 w-10 text-gray-300"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"No active sessions yet"}),e.jsx("p",{className:"text-sm text-gray-500 max-w-sm",children:"Start a conversation in the chat area to begin your coaching journey and create your first session."})]}),e.jsx("div",{className:"flex items-center space-x-2 text-xs text-gray-400 mt-6",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),e.jsx("span",{children:"Ready to chat"})]})})]})}):e.jsx("div",{className:"p-4 space-y-3",children:Object.entries(d).map(([o,t])=>e.jsxs("div",{className:`p-3 rounded-lg border cursor-pointer transition-colors ${h===o?"bg-green-50 border-green-300 shadow-sm ring-2 ring-green-200":J===o?"bg-blue-50 border-blue-200":"bg-white hover:bg-gray-50"}`,onClick:()=>ee(o,t),children:[e.jsx("div",{className:"flex items-start justify-between mb-2",children:e.jsxs("div",{className:"font-medium text-sm truncate flex-1",children:[t.name||`Session ${o.substring(o.length-8)}`,h===o&&e.jsx("span",{className:"ml-2 text-xs bg-green-500 text-white px-2 py-0.5 rounded-full",children:"Current"})]})}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsx(Se,{className:"h-3 w-3"}),e.jsx("span",{children:V(t.created_at)})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-1",children:[e.jsx(me,{className:"h-3 w-3"}),e.jsxs("span",{children:["Updated ",V(t.updated_at)]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400 mt-1",children:[e.jsx(y,{className:"h-3 w-3"}),e.jsxs("span",{children:[t.value?.turns?.length||0," messages"]})]})]},o))})})})]})}),e.jsx("div",{className:"flex-1",children:e.jsx(P,{className:"h-full py-0",children:e.jsx(G,{className:"p-0 h-full",children:u?e.jsxs("div",{className:"h-full w-full rounded-lg overflow-hidden flex flex-col relative",children:[e.jsxs("div",{className:"flex items-center p-4 bg-white",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(w,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-blue-50 hover:text-blue-600",onClick:()=>{console.log("ğŸ’¬ Switch to text chat");const o=new URL(window.location.href);o.searchParams.delete("mode"),window.location.href=o.toString()},children:e.jsx(y,{className:"h-4 w-4"})}),e.jsx("div",{className:"w-px h-5 bg-gray-300"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:b?.name||f||"Audio Session"})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[e.jsx(w,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-green-50 hover:text-green-600",onClick:F,children:e.jsx(K,{className:"h-4 w-4"})}),e.jsx(w,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-red-50 hover:text-red-600",onClick:W,children:e.jsx(M,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"flex-1 relative",children:e.jsx("elevenlabs-convai",{ref:Z,"data-test":"elevenlabs-convai","agent-id":"agent_0901k31ke64mf0w8me1gdwygb7ze",style:{display:"block",opacity:"0",position:"absolute",top:"0",left:"0",width:"100%",height:"100%",minHeight:"400px",border:"none",borderRadius:"0 0 8px 8px",transition:"opacity 0.5s ease-in-out"}})})]}):e.jsxs("div",{className:"h-full w-full rounded-lg overflow-hidden flex flex-col relative",children:[e.jsxs("div",{className:"flex items-center p-4 bg-white",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(w,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-blue-50 hover:text-blue-600",onClick:()=>{console.log("ğŸ™ï¸ Switch to audio mode");const o=new URL(window.location.href);o.searchParams.set("mode","audio"),window.location.href=o.toString()},children:e.jsx(pe,{className:"h-4 w-4"})}),e.jsx("div",{className:"w-px h-5 bg-gray-300"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:b?.name||f||"Text Chat"})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[e.jsx(w,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-green-50 hover:text-green-600",onClick:F,children:e.jsx(K,{className:"h-4 w-4"})}),e.jsx(w,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-red-50 hover:text-red-600",onClick:W,children:e.jsx(M,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"flex-1 relative",children:e.jsx("div",{id:"main-voiceflow-chat",className:"absolute inset-0",children:e.jsx("div",{className:"flex items-center justify-center h-full bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx(y,{className:"h-8 w-8 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-gray-500",children:"Loading chat interface..."})]})})})})]})})})})]}),e.jsx(le,{open:X,onOpenChange:x,children:e.jsxs(ae,{className:"sm:max-w-[425px]",children:[e.jsxs(re,{children:[e.jsx(ce,{children:m==="positive"?"ğŸ‘ Share your positive feedback":"ğŸ‘ Help us improve"}),e.jsx(ie,{children:m==="positive"?"We'd love to hear what you enjoyed about this session!":"Let us know what went wrong so we can improve your experience."})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"feedback-comment",className:"text-sm font-medium",children:[m==="positive"?"What did you like?":"What can we improve?"," ","(optional)"]}),e.jsx(ye,{id:"feedback-comment",placeholder:m==="positive"?"Tell us what worked well...":"Tell us what didn't work or what you expected...",value:C,onChange:o=>O(o.target.value),className:"mt-2",rows:4})]})}),e.jsxs(de,{children:[e.jsx(w,{variant:"outline",onClick:()=>{x(!1),j(null),O("")},disabled:k,children:"Cancel"}),e.jsx(w,{onClick:oe,disabled:k,className:m==="positive"?"bg-green-600 hover:bg-green-700":"bg-blue-600 hover:bg-blue-700",children:k?"Submitting...":"Submit Feedback"})]})]})})]})}export{Ae as default};
