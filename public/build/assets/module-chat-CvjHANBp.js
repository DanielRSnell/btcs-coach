import{r as i,u as F,j as e,H as U,L as R,a as q}from"./app-zS8rH3uI.js";import{A as Y,M as K}from"./app-layout-DbAfPBNq.js";import{a as b,B as o}from"./app-logo-icon-tdYYiPrB.js";import{C as d,a as x,c as m,b as f,d as T}from"./card-DMMaGNNX.js";import{B as c}from"./badge-CneR7pQ8.js";import{T as G,a as Q,b as D,c as E}from"./tabs-CmOMWgw_.js";import{D as W,a as X,b as Z,c as ee,d as se,e as ae}from"./dialog-CJUdyNjT.js";import{M as te}from"./mic-Dlc6g3Yi.js";import{C as I}from"./clock-CsI3cpyk.js";import{T as N}from"./target-92409N8C.js";import{B as M}from"./book-open-DUkCtm8h.js";import{m as le}from"./proxy-CJLbCFai.js";import{C as ie}from"./circle-check-big-Du_XuiRK.js";/* empty css            */import"./index-CAadjkBG.js";import"./index-lp9UGJZ_.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],ne=b("ArrowLeft",ce);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],oe=b("CircleAlert",re);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],xe=b("Circle",de),me={coaching:"bg-green-100 text-green-800",training:"bg-yellow-100 text-yellow-800",assessment:"bg-blue-100 text-blue-800"},he={beginner:"bg-emerald-100 text-emerald-800",intermediate:"bg-amber-100 text-amber-800",advanced:"bg-red-100 text-red-800"},L={low:"bg-blue-100 text-blue-800",medium:"bg-yellow-100 text-yellow-800",high:"bg-red-100 text-red-800"},V=t=>{switch(t){case"completed":return e.jsx(ie,{className:"h-4 w-4 text-green-500"});case"in_progress":return e.jsx(oe,{className:"h-4 w-4 text-yellow-500"});default:return e.jsx(xe,{className:"h-4 w-4 text-gray-400"})}};function De({module:t,user:s,actionItems:w=[]}){const[l,j]=i.useState(null),[z,h]=i.useState(!1),[_,n]=i.useState(!1),[r,C]=i.useState("voiceflow"),B=i.useRef(null),{props:O}=F(),u=O.flash?.success;i.useEffect(()=>{u&&console.log("Success:",u)},[u]);const H=a=>{j(a),h(!0)},$=()=>{h(!1),j(null),n(!1)},P=()=>{l&&(n(!0),q.put(`/action-items/${l.id}/complete`,{},{preserveState:!1,preserveScroll:!0,onSuccess:a=>{h(!1),j(null),n(!1),console.log("Action item marked as completed successfully")},onError:a=>{console.error("Failed to update action item:",a),alert("Failed to update action item. Please try again."),n(!1)},onFinish:()=>{n(!1)}}))};i.useEffect(()=>{if(!document.querySelector('script[src*="convai-widget-embed"]')){const a=document.createElement("script");a.src="https://unpkg.com/@elevenlabs/convai-widget-embed",a.async=!0,a.type="text/javascript",document.head.appendChild(a)}},[]);const y={user_profile:JSON.stringify({id:s?.id||0,name:s?.name||"Anonymous",email:s?.email||"",role:s?.role||"member",pi_behavioral_pattern_id:s?.pi_behavioral_pattern_id||null,pi_behavioral_pattern:s?.pi_behavioral_pattern||null,pi_raw_scores:s?.pi_raw_scores||null,pi_assessed_at:s?.pi_assessed_at||null,pi_notes:s?.pi_notes||null,pi_profile:s?.pi_profile||null,has_pi_assessment:s?.has_pi_assessment||!1,has_pi_profile:s?.has_pi_profile||!1}),user_name:s?.name?s.name.split(" ")[0]:"Anonymous"};return console.log("ðŸš€ ElevenLabs Variables Structure:",y),console.log("ðŸš€ ElevenLabs Final JSON:",JSON.stringify(y)),i.useEffect(()=>{const a=()=>{setTimeout(()=>{console.log("Starting Voiceflow initialization...");const v=document.getElementById("btcs-chat");console.log("Chat element found:",v);const J={id:s?.id||0,name:s?.name||"Anonymous",email:s?.email||"",role:s?.role||"member",pi_behavioral_pattern_id:s?.pi_behavioral_pattern_id||null,pi_behavioral_pattern:s?.pi_behavioral_pattern||null,pi_raw_scores:s?.pi_raw_scores||null,pi_assessed_at:s?.pi_assessed_at||null,pi_notes:s?.pi_notes||null,pi_profile:s?.pi_profile||null,has_pi_assessment:s?.has_pi_assessment||!1,has_pi_profile:s?.has_pi_profile||!1};console.log("ðŸš€ Voiceflow User Payload:",JSON.stringify(J,null,2)),function(k,S){var g=k.createElement(S),A=k.getElementsByTagName(S)[0];g.onload=function(){console.log("Voiceflow script loaded, window.voiceflow:",window.voiceflow),console.log("Voiceflow chat loaded for module:",t.title)},g.src="https://cdn.voiceflow.com/widget-next/bundle.mjs",g.type="text/javascript",A.parentNode.insertBefore(g,A)}(document,"script")},100),console.log("Voiceflow initialization started for module:",t.title)},p=()=>{if(window.voiceflow&&window.voiceflow.chat)try{window.voiceflow.chat.destroy(),console.log("Voiceflow chat destroyed")}catch(v){console.warn("Error cleaning up Voiceflow:",v)}};return p(),a(),p},[t,s]),e.jsxs(Y,{children:[e.jsx(U,{title:`${t.title} - Interactive Session`}),e.jsxs("div",{className:"flex gap-6",style:{height:"calc(100vh - 200px)"},children:[e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx(R,{href:"/modules",children:e.jsxs(o,{variant:"outline",size:"sm",children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"Back to Modules"]})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:t.title}),e.jsx("p",{className:"text-sm text-gray-600",children:"Interactive Coaching Session"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{variant:"outline",size:"sm",children:"Save Progress"}),e.jsx(o,{variant:"outline",size:"sm",children:"End Session"})]})]}),e.jsxs(d,{className:"flex-1 flex flex-col py-0",style:{minHeight:"500px",maxHeight:"calc(100vh - 280px)"},children:[e.jsx(x,{className:"py-3 px-4 border-b",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("button",{onClick:()=>C("voiceflow"),className:`inline-flex items-center gap-2 px-3 py-2 text-sm font-medium rounded-lg transition-colors ${r==="voiceflow"?"bg-blue-100 text-blue-700 border-blue-200 border":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:[e.jsx(K,{className:"h-4 w-4"}),"Text Chat"]}),e.jsxs("button",{onClick:()=>C("elevenlabs"),className:`inline-flex items-center gap-2 px-3 py-2 text-sm font-medium rounded-lg transition-colors ${r==="elevenlabs"?"bg-green-100 text-green-700 border-green-200 border":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:[e.jsx(te,{className:"h-4 w-4"}),"Voice Chat"]})]}),e.jsx("div",{className:"text-sm text-gray-500 ml-auto",children:r==="voiceflow"?"Text-based coaching conversation":"Voice-based AI coaching"})]})}),e.jsxs(m,{className:"p-0 flex-1 relative",children:[e.jsx("div",{id:"btcs-chat",className:`w-full h-full ${r==="voiceflow"?"block":"hidden"}`,style:{maxHeight:"calc(100vh - 200px)"},children:e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-pulse",children:e.jsx("div",{className:"w-8 h-8 bg-blue-200 rounded-full mx-auto mb-4"})}),e.jsx("p",{children:"Initializing your coaching session..."}),e.jsx("p",{className:"text-sm mt-2",children:"Your AI coach will appear here shortly."})]})})}),r==="elevenlabs"&&e.jsx("div",{className:"w-full h-full",children:e.jsx("div",{className:"w-full h-full relative",children:e.jsx("elevenlabs-convai",{ref:B,"agent-id":"agent_0901k31ke64mf0w8me1gdwygb7ze","dynamic-variables":JSON.stringify(y),style:{position:"relative",width:"100%",height:"100%",display:"block"}})})})]})]})]}),e.jsx("div",{className:"w-80",children:e.jsxs(G,{defaultValue:"info",className:"w-full",children:[e.jsxs(Q,{className:"grid w-full grid-cols-2",children:[e.jsx(D,{value:"info",children:"Info"}),e.jsx(D,{value:"actions",children:"Actions"})]}),e.jsxs(E,{value:"info",className:"space-y-4 mt-4",children:[e.jsxs(d,{children:[e.jsxs(x,{className:"pb-3",children:[e.jsx(f,{className:"text-lg",children:t.title}),e.jsx(T,{className:"text-sm",children:t.description})]}),e.jsxs(m,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{className:me[t.type],children:t.type}),e.jsx(c,{variant:"outline",className:he[t.difficulty],children:t.difficulty})]}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-500",children:[e.jsx(I,{className:"h-4 w-4"}),e.jsxs("span",{children:[t.estimated_duration," minutes"]})]})]})]}),e.jsxs(d,{children:[e.jsx(x,{className:"pb-3",children:e.jsxs(f,{className:"flex items-center gap-2 text-lg",children:[e.jsx(N,{className:"h-5 w-5"}),"Session Overview"]})}),e.jsxs(m,{className:"space-y-4",children:[t.topics&&t.topics.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(M,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Key Topics:"})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:t.topics.map((a,p)=>e.jsx(c,{variant:"secondary",className:"text-xs",children:a},p))})]}),t.learning_objectives&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(N,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Learning Objectives:"})]}),e.jsx("p",{className:"text-sm text-gray-600 leading-relaxed",children:t.learning_objectives})]})]})]}),e.jsxs(d,{children:[e.jsx(x,{className:"pb-3",children:e.jsx(f,{className:"text-lg",children:"Session Progress"})}),e.jsx(m,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Status"}),e.jsx("span",{className:"font-medium text-green-600",children:"In Progress"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Started"}),e.jsx("span",{className:"font-medium",children:"Just now"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Estimated Time"}),e.jsxs("span",{className:"font-medium",children:[t.estimated_duration," min"]})]})]})})]})]}),e.jsx(E,{value:"actions",className:"space-y-4 mt-4",children:e.jsxs(d,{children:[e.jsxs(x,{className:"pb-3",children:[e.jsx(f,{className:"text-lg",children:"Module Action Items"}),e.jsxs(T,{className:"text-sm",children:["Your personalized tasks and objectives for ",t.title]})]}),e.jsx(m,{children:w.length===0?e.jsxs("div",{className:"text-center py-6 text-gray-500",children:[e.jsx(N,{className:"h-8 w-8 mx-auto mb-2 text-gray-300"}),e.jsx("p",{className:"text-sm",children:"No action items for this module yet"}),e.jsx("p",{className:"text-xs mt-1",children:"Complete coaching sessions to generate personalized tasks"})]}):e.jsx("div",{className:"space-y-3",children:w.map(a=>e.jsxs(le.div,{className:"border rounded-lg p-3 space-y-2 cursor-pointer hover:bg-gray-50 transition-colors",onClick:()=>H(a),whileHover:{scale:1.01},whileTap:{scale:.99},children:[e.jsxs("div",{className:"flex items-start gap-2",children:[V(a.status),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 truncate",children:a.title}),e.jsx("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:a.description})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{variant:"outline",className:`text-xs ${L[a.priority]}`,children:a.priority}),a.due_date&&e.jsxs("span",{className:"text-xs text-gray-500",children:["Due ",new Date(a.due_date).toLocaleDateString()]})]}),a.context&&e.jsx("div",{className:"text-xs text-gray-500 italic truncate",children:a.context})]},a.id))})})]})})]})})]}),e.jsx(W,{open:z,onOpenChange:h,children:e.jsxs(X,{className:"max-w-2xl",children:[e.jsxs(Z,{children:[e.jsxs(ee,{className:"flex items-center gap-2",children:[l&&V(l.status),l?.title]}),e.jsx(se,{children:"Action item details and progress tracking"})]}),l&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Status:"}),e.jsx(c,{variant:l.status==="completed"?"default":"secondary",children:l.status.replace("_"," ")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Priority:"}),e.jsx(c,{variant:"outline",className:L[l.priority],children:l.priority})]})]}),l.due_date&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-sm text-gray-700",children:["Due: ",new Date(l.due_date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Description"}),e.jsx("p",{className:"text-sm text-gray-700 leading-relaxed",children:l.description})]}),l.context&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Context"}),e.jsx("p",{className:"text-sm text-gray-600 italic",children:l.context})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(M,{className:"h-4 w-4 text-blue-600"}),e.jsx("h4",{className:"text-sm font-medium text-blue-900",children:"Related Module"})]}),e.jsx("p",{className:"text-sm text-blue-800",children:t.title}),e.jsx("p",{className:"text-xs text-blue-600 mt-1",children:t.description})]})]}),e.jsxs(ae,{children:[e.jsx(o,{variant:"outline",onClick:$,children:"Close"}),l?.status!=="completed"&&e.jsx(o,{onClick:P,disabled:_,children:_?"Updating...":"Mark as Completed"})]})]})})]})}export{De as default};
