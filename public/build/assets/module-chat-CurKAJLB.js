import{r as o,b as P,j as e,H as U,L as $,c as F}from"./app-CB55lnze.js";import{A as q}from"./app-layout-AJEJ4epG.js";import{a as N,B as d}from"./app-logo-icon-CqXuE6Wz.js";import{C as x,c as m,a as f,b as g,d as D,B as c}from"./badge-BsfMP0AX.js";import{T as J,a as R,b as I,c as T}from"./tabs-BGDy_T3h.js";import{D as Y,a as K,b as G,c as Q,d as W,e as X}from"./dialog-DqdWGm80.js";import{C as A}from"./clock-BYYrvJin.js";import{T as v}from"./target-hUhlDwIj.js";import{B as E}from"./book-open-BYoRYXlg.js";import{m as Z}from"./proxy-CAFPrhr5.js";import{C as ee}from"./circle-check-big-BbaBWspN.js";/* empty css            */import"./index-ZgwDwYwx.js";import"./index-C3AWhQFt.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],te=N("ArrowLeft",se);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],ie=N("CircleAlert",ae);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ce=N("Circle",le),ne={coaching:"bg-green-100 text-green-800",training:"bg-yellow-100 text-yellow-800",assessment:"bg-blue-100 text-blue-800"},re={beginner:"bg-emerald-100 text-emerald-800",intermediate:"bg-amber-100 text-amber-800",advanced:"bg-red-100 text-red-800"},B={low:"bg-blue-100 text-blue-800",medium:"bg-yellow-100 text-yellow-800",high:"bg-red-100 text-red-800"},M=s=>{switch(s){case"completed":return e.jsx(ee,{className:"h-4 w-4 text-green-500"});case"in_progress":return e.jsx(ie,{className:"h-4 w-4 text-yellow-500"});default:return e.jsx(ce,{className:"h-4 w-4 text-gray-400"})}};function be({module:s,user:i,actionItems:w=[]}){const[a,j]=o.useState(null),[V,p]=o.useState(!1),[b,n]=o.useState(!1),{props:L}=P(),u=L.flash?.success;o.useEffect(()=>{u&&console.log("Success:",u)},[u]);const z=t=>{j(t),p(!0)},H=()=>{p(!1),j(null),n(!1)},O=()=>{a&&(n(!0),F.put(`/action-items/${a.id}/complete`,{},{preserveState:!1,preserveScroll:!0,onSuccess:t=>{p(!1),j(null),n(!1),console.log("Action item marked as completed successfully")},onError:t=>{console.error("Failed to update action item:",t),alert("Failed to update action item. Please try again."),n(!1)},onFinish:()=>{n(!1)}}))};return o.useEffect(()=>{const t=()=>{setTimeout(()=>{console.log("Starting Voiceflow initialization...");const y=document.getElementById("btcs-chat");console.log("Chat element found:",y),function(_,C){var r=_.createElement(C),S=_.getElementsByTagName(C)[0];r.onload=function(){if(console.log("Voiceflow script loaded, window.voiceflow:",window.voiceflow),window.voiceflow&&window.voiceflow.chat){const l=document.getElementById("btcs-chat");console.log("Target element for Voiceflow:",l);const k={route:{name:"modules.chat",path:`/modules/${s.slug}/chat`,params:{slug:s.slug}},module:{id:s.id,title:s.title,description:s.description,goal:s.goal,type:s.type,slug:s.slug,topics:s.topics,topics_string:s.topics.join(", "),sample_questions:s.sample_questions,learning_objectives:s.learning_objectives,expected_outcomes:s.expected_outcomes,estimated_duration:s.estimated_duration,difficulty:s.difficulty},user:{id:i?.id||0,name:i?.name||"Anonymous",email:i?.email||"",role:i?.role||"member",pi_behavioral_pattern_id:i?.pi_behavioral_pattern_id||null,pi_behavioral_pattern:i?.pi_behavioral_pattern||null,pi_raw_scores:i?.pi_raw_scores||null,pi_assessed_at:i?.pi_assessed_at||null,pi_notes:i?.pi_notes||null,pi_profile:i?.pi_profile||null,has_pi_assessment:i?.has_pi_assessment||!1,has_pi_profile:i?.has_pi_profile||!1},session_context:"pi_ssl_coaching"};console.log("ðŸš€ Voiceflow Payload:",JSON.stringify(k,null,2)),window.voiceflow.chat.load({verify:{projectID:"686331bc96acfa1dd62f6fd5"},url:"https://general-runtime.voiceflow.com",versionID:"production",voice:{url:"https://runtime-api.voiceflow.com"},render:{mode:"embedded",target:l},assistant:{stylesheet:"/voiceflow.css?v="+new Date().toISOString().replace(/[:.]/g,"-"),persistence:"memory"},autostart:!0,launch:{event:{type:"launch",payload:k}}}),console.log("Voiceflow chat loaded for module:",s.title)}else{console.error("Voiceflow widget failed to load - missing window.voiceflow");const l=document.getElementById("btcs-chat");l&&(l.innerHTML=`
                                    <div class="flex items-center justify-center h-full text-gray-500">
                                        <div class="text-center">
                                            <p class="text-lg font-medium text-red-600 mb-2">Chat Temporarily Unavailable</p>
                                            <p class="text-sm">Please refresh the page or try again later.</p>
                                            <p class="text-xs mt-2 text-gray-400">Error: Voiceflow widget failed to initialize</p>
                                        </div>
                                    </div>
                                `)}},r.onerror=function(){console.error("Failed to load Voiceflow script from CDN");const l=document.getElementById("btcs-chat");l&&(l.innerHTML=`
                                <div class="flex items-center justify-center h-full text-gray-500">
                                    <div class="text-center">
                                        <p class="text-lg font-medium text-red-600 mb-2">Chat Service Unavailable</p>
                                        <p class="text-sm">Unable to connect to chat service.</p>
                                        <p class="text-xs mt-2 text-gray-400">Please contact support if this issue persists.</p>
                                    </div>
                                </div>
                            `)},r.src="https://cdn.voiceflow.com/widget-next/bundle.mjs",r.type="text/javascript",console.log("Adding Voiceflow script to DOM..."),S.parentNode.insertBefore(r,S)}(document,"script")},100),console.log("Voiceflow initialization started for module:",s.title)},h=()=>{if(window.voiceflow&&window.voiceflow.chat)try{window.voiceflow.chat.destroy(),console.log("Voiceflow chat destroyed")}catch(y){console.warn("Error cleaning up Voiceflow:",y)}};return h(),t(),h},[s,i]),e.jsxs(q,{children:[e.jsx(U,{title:`${s.title} - Interactive Session`}),e.jsxs("div",{className:"flex gap-6",style:{height:"calc(100vh - 200px)"},children:[e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx($,{href:"/modules",children:e.jsxs(d,{variant:"outline",size:"sm",children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Back to Modules"]})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:s.title}),e.jsx("p",{className:"text-sm text-gray-600",children:"Interactive Coaching Session"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{variant:"outline",size:"sm",children:"Save Progress"}),e.jsx(d,{variant:"outline",size:"sm",children:"End Session"})]})]}),e.jsx(x,{className:"flex-1 flex flex-col py-0",style:{minHeight:"500px",maxHeight:"calc(100vh - 280px)"},children:e.jsx(m,{className:"p-0 flex-1",children:e.jsx("div",{id:"btcs-chat",className:"w-full h-full",style:{maxHeight:"calc(100vh - 200px)"},children:e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-pulse",children:e.jsx("div",{className:"w-8 h-8 bg-blue-200 rounded-full mx-auto mb-4"})}),e.jsx("p",{children:"Initializing your coaching session..."}),e.jsx("p",{className:"text-sm mt-2",children:"Your AI coach will appear here shortly."})]})})})})})]}),e.jsx("div",{className:"w-80",children:e.jsxs(J,{defaultValue:"info",className:"w-full",children:[e.jsxs(R,{className:"grid w-full grid-cols-2",children:[e.jsx(I,{value:"info",children:"Info"}),e.jsx(I,{value:"actions",children:"Actions"})]}),e.jsxs(T,{value:"info",className:"space-y-4 mt-4",children:[e.jsxs(x,{children:[e.jsxs(f,{className:"pb-3",children:[e.jsx(g,{className:"text-lg",children:s.title}),e.jsx(D,{className:"text-sm",children:s.description})]}),e.jsxs(m,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{className:ne[s.type],children:s.type}),e.jsx(c,{variant:"outline",className:re[s.difficulty],children:s.difficulty})]}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-500",children:[e.jsx(A,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.estimated_duration," minutes"]})]})]})]}),e.jsxs(x,{children:[e.jsx(f,{className:"pb-3",children:e.jsxs(g,{className:"flex items-center gap-2 text-lg",children:[e.jsx(v,{className:"h-5 w-5"}),"Session Overview"]})}),e.jsxs(m,{className:"space-y-4",children:[s.topics&&s.topics.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(E,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Key Topics:"})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.topics.map((t,h)=>e.jsx(c,{variant:"secondary",className:"text-xs",children:t},h))})]}),s.learning_objectives&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(v,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Learning Objectives:"})]}),e.jsx("p",{className:"text-sm text-gray-600 leading-relaxed",children:s.learning_objectives})]})]})]}),e.jsxs(x,{children:[e.jsx(f,{className:"pb-3",children:e.jsx(g,{className:"text-lg",children:"Session Progress"})}),e.jsx(m,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Status"}),e.jsx("span",{className:"font-medium text-green-600",children:"In Progress"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Started"}),e.jsx("span",{className:"font-medium",children:"Just now"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Estimated Time"}),e.jsxs("span",{className:"font-medium",children:[s.estimated_duration," min"]})]})]})})]})]}),e.jsx(T,{value:"actions",className:"space-y-4 mt-4",children:e.jsxs(x,{children:[e.jsxs(f,{className:"pb-3",children:[e.jsx(g,{className:"text-lg",children:"Module Action Items"}),e.jsxs(D,{className:"text-sm",children:["Your personalized tasks and objectives for ",s.title]})]}),e.jsx(m,{children:w.length===0?e.jsxs("div",{className:"text-center py-6 text-gray-500",children:[e.jsx(v,{className:"h-8 w-8 mx-auto mb-2 text-gray-300"}),e.jsx("p",{className:"text-sm",children:"No action items for this module yet"}),e.jsx("p",{className:"text-xs mt-1",children:"Complete coaching sessions to generate personalized tasks"})]}):e.jsx("div",{className:"space-y-3",children:w.map(t=>e.jsxs(Z.div,{className:"border rounded-lg p-3 space-y-2 cursor-pointer hover:bg-gray-50 transition-colors",onClick:()=>z(t),whileHover:{scale:1.01},whileTap:{scale:.99},children:[e.jsxs("div",{className:"flex items-start gap-2",children:[M(t.status),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 truncate",children:t.title}),e.jsx("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:t.description})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{variant:"outline",className:`text-xs ${B[t.priority]}`,children:t.priority}),t.due_date&&e.jsxs("span",{className:"text-xs text-gray-500",children:["Due ",new Date(t.due_date).toLocaleDateString()]})]}),t.context&&e.jsx("div",{className:"text-xs text-gray-500 italic truncate",children:t.context})]},t.id))})})]})})]})})]}),e.jsx(Y,{open:V,onOpenChange:p,children:e.jsxs(K,{className:"max-w-2xl",children:[e.jsxs(G,{children:[e.jsxs(Q,{className:"flex items-center gap-2",children:[a&&M(a.status),a?.title]}),e.jsx(W,{children:"Action item details and progress tracking"})]}),a&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Status:"}),e.jsx(c,{variant:a.status==="completed"?"default":"secondary",children:a.status.replace("_"," ")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Priority:"}),e.jsx(c,{variant:"outline",className:B[a.priority],children:a.priority})]})]}),a.due_date&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-sm text-gray-700",children:["Due: ",new Date(a.due_date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Description"}),e.jsx("p",{className:"text-sm text-gray-700 leading-relaxed",children:a.description})]}),a.context&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Context"}),e.jsx("p",{className:"text-sm text-gray-600 italic",children:a.context})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(E,{className:"h-4 w-4 text-blue-600"}),e.jsx("h4",{className:"text-sm font-medium text-blue-900",children:"Related Module"})]}),e.jsx("p",{className:"text-sm text-blue-800",children:s.title}),e.jsx("p",{className:"text-xs text-blue-600 mt-1",children:s.description})]})]}),e.jsxs(X,{children:[e.jsx(d,{variant:"outline",onClick:H,children:"Close"}),a?.status!=="completed"&&e.jsx(d,{onClick:O,disabled:b,children:b?"Updating...":"Mark as Completed"})]})]})})]})}export{be as default};
