import{j as e,u as le,r as g,H as ae,a as G}from"./app-CZagCsyc.js";import{A as ie,M as S,S as re,a as ce,b as de,c as ge,d as me,e as he,D as ue,f as fe,g as pe,h as we,i as xe,j as Se}from"./app-layout-B-lwyiGW.js";import{C as M,a as ve,b as ye,c as be,d as H}from"./card-8hvmkF2q.js";import{c as I,a as Ne,B as h}from"./app-logo-icon-Dzl2gkkk.js";import{M as je}from"./mic-pzCpmNNq.js";import{C as Ee}from"./clock-DAmv9JDE.js";/* empty css            */import"./index-BUvEDGjO.js";import"./label-Clw3fUZj.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Ce=I("Calendar",Ie);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]],ke=I("Menu",Oe);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]],K=I("ThumbsDown",_e);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]],z=I("ThumbsUp",De);function Te({className:c,...d}){return e.jsx("textarea",{"data-slot":"textarea",className:Ne("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",c),...d})}function He({user:c,sessions:d,currentSessionId:D,currentSession:b,newSessionName:C,newSessionStatus:J,isAudioMode:u}){console.log("ğŸ” Sessions component loaded with data:"),console.log("ğŸ‘¤ User received:",c?.name,c?.id),console.log("ğŸ“Š Sessions received:",d),console.log("ğŸ“Š Sessions type:",typeof d),console.log("ğŸ“Š Sessions keys:",d?Object.keys(d):"sessions is null/undefined"),console.log("ğŸ“Š Sessions count:",d?Object.keys(d).length:0),console.log("ğŸ¯ Current Session ID received:",D),console.log("ğŸ¯ Current Session data received:",b),console.log("ğŸ†• New Session Name received:",C),console.log("ğŸ†• New Session Status received:",J),console.log("ğŸµ Audio mode received from server:",u);const{props:Ae}=le(),[B,q]=g.useState(null),[T,Y]=g.useState(!1),[m,N]=g.useState(null),[Le,X]=g.useState(!1),[f,Z]=g.useState(C||null),[Q,A]=g.useState(!1),[ee,v]=g.useState(!1),[p,j]=g.useState(null),[O,k]=g.useState(""),[_,L]=g.useState(!1),oe=g.useRef(null);g.useCallback(o=>{o&&u&&console.log("ğŸ¯ ElevenLabs container element mounted")},[u]);const $=()=>{console.log("ğŸ”„ External refresh requested - reloading sessions data..."),console.log("ğŸ”„ Current sessions before reload:",d),console.log("ğŸ”„ Sessions count before reload:",Object.keys(d).length),G.reload({only:["sessions"],onSuccess:o=>{console.log("âœ… Reload successful - new page data:",o),console.log("âœ… New sessions data:",o.props.sessions),console.log("âœ… New sessions count:",Object.keys(o.props.sessions||{}).length)},onError:o=>{console.error("âŒ Reload failed:",o)}})};g.useEffect(()=>(window.refreshSessionsList=$,console.log("âœ… Global function window.refreshSessionsList() is now available"),()=>{delete window.refreshSessionsList,console.log("ğŸ§¹ Cleaned up window.refreshSessionsList()")}),[$]),g.useEffect(()=>{if(!document.querySelector('script[src*="widget-next/bundle.mjs"]')){const o=document.createElement("script");o.src="https://cdn.voiceflow.com/widget-next/bundle.mjs",o.async=!0,o.type="text/javascript",document.head.appendChild(o)}},[]);const se=()=>{console.log("ğŸ”„ INITIALIZING VOICEFLOW: Starting initialization..."),setTimeout(()=>{console.log("ğŸ¯ DOM READY: Starting Voiceflow initialization...");const o=document.getElementById("main-voiceflow-chat");console.log("ğŸ“ Chat element found:",o),window.voiceflow&&window.voiceflow.chat?(console.log("âœ… VOICEFLOW AVAILABLE: Using existing Voiceflow instance"),R()):(console.log("ğŸš€ LOADING VOICEFLOW: Loading Voiceflow script..."),function(t,l){const n=t.createElement(l),s=t.getElementsByTagName(l)[0];n.onload=function(){console.log("ğŸ“¦ SCRIPT LOADED: Voiceflow script loaded, window.voiceflow:",window.voiceflow),R()},n.src="https://cdn.voiceflow.com/widget-next/bundle.mjs",n.type="text/javascript",s.parentNode?.insertBefore(n,s)}(document,"script"))},100)},R=()=>{if(console.log("âš¡ LOADING CHAT: Configuring Voiceflow chat..."),window.voiceflow&&window.voiceflow.chat){const o=document.getElementById("main-voiceflow-chat");console.log("ğŸ¯ Target element for Voiceflow:",o);const t=window.ChatInfo?.payload||{},l=window.ChatInfo?.name||"";console.log("ğŸš€ Voiceflow User Payload:",JSON.stringify(t,null,2)),console.log("ğŸš€ Voiceflow Chat Name:",l),window.voiceflow.chat.load({verify:{projectID:"686331bc96acfa1dd62f6fd5"},url:"https://general-runtime.voiceflow.com",versionID:"production",assistant:{type:"chat",banner:{title:l},extensions:[window.AdaptiveCardExtension],stylesheet:"/voiceflow.css?v="+new Date().toISOString().replace(/[:.]/g,"-"),inputPlaceholder:"What's my PI Profile?"},render:{mode:"embedded",target:o},autostart:!0,launch:{event:{type:"launch",payload:t}}}),console.log("âœ… CHAT LOADED: Voiceflow chat loaded successfully"),X(!0);let n=0;const s=10,a=()=>{n++;const i=Object.keys(localStorage).filter(r=>r.startsWith("voiceflow-session-"));console.log(`ğŸ”„ POST-VOICEFLOW SCAN (attempt ${n}): Found ${i.length} localStorage sessions`),i.length>0?(console.log("âœ… New localStorage sessions detected, running scan..."),console.log("ğŸ¯ Pending session name for registration:",f),console.log("ğŸ¯ New session name from props:",C),V()):n<s?setTimeout(a,500):console.log("â° Max attempts reached, no new sessions found after Voiceflow load")};setTimeout(a,1e3),f&&(console.log("ğŸ¯ NEW SESSION FLOW: Detected pendingSessionName, setting up direct registration..."),setTimeout(()=>{console.log("ğŸ¯ NEW SESSION FLOW: Attempting direct registration for new session...");const i=Object.keys(localStorage).filter(r=>r.startsWith("voiceflow-session-"));i.length>0?(console.log("ğŸ¯ NEW SESSION FLOW: Found localStorage entries, processing..."),i.forEach(async r=>{const w=localStorage.getItem(r);w&&(console.log(`ğŸ¯ NEW SESSION FLOW: Processing ${r} with pending name "${f}"`),await y(r,w))})):console.log("ğŸ¯ NEW SESSION FLOW: No localStorage entries found yet")},2e3))}else{console.error("âŒ VOICEFLOW MISSING: Voiceflow widget failed to load - missing window.voiceflow");const o=document.getElementById("main-voiceflow-chat");o&&(o.innerHTML=`
                    <div class="flex items-center justify-center h-96 bg-gray-50 rounded-lg">
                        <div class="text-center">
                            <div class="text-gray-500 mb-2">Chat widget failed to load</div>
                            <button onclick="location.reload()" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">
                                Retry
                            </button>
                        </div>
                    </div>
                `)}};g.useEffect(()=>{let o=[];try{const s=Object.keys(localStorage).filter(a=>a.includes("cmeu"));if(console.log('ğŸ” Checking for localStorage keys containing "cmeu":',s),s.length>0){const a=s[0],i=localStorage.getItem(a);if(i){console.log(`ğŸ“¦ Found cmeu data in key "${a}"`);const r=JSON.parse(i);r.turns&&Array.isArray(r.turns)?(o=r.turns,console.log(`âœ… Extracted ${o.length} turns from cmeu localStorage:`,o)):console.log("âš ï¸ No turns array found in cmeu data")}else console.log(`âš ï¸ No data found for cmeu key "${a}"`)}else console.log('ğŸ“­ No localStorage keys containing "cmeu" found')}catch(n){console.error("âŒ Error extracting voicechat_history from localStorage:",n)}const t={id:c?.id||0,name:c?.name||"Anonymous",email:c?.email||"",role:c?.role||"member",employee_number:c?.employee_number||null,org_level_2:c?.org_level_2||null,job:c?.job||null,job_code:c?.job_code||null,employment_status:c?.employment_status||null,team_members:c?.team_members||[],pi_behavioral_pattern_id:c?.pi_behavioral_pattern_id||null,pi_behavioral_pattern:c?.pi_behavioral_pattern||null,pi_raw_scores:c?.pi_raw_scores||null,pi_assessed_at:c?.pi_assessed_at||null,pi_notes:c?.pi_notes||null,pi_profile:c?.pi_profile||null,has_pi_assessment:c?.has_pi_assessment||!1,has_pi_profile:c?.has_pi_profile||!1,voicechat_history:o},l=b?.name||f||"";if(window.ChatInfo={name:l,payload:t},console.log("âœ… window.ChatInfo created for",u?"AUDIO":"TEXT","mode:",window.ChatInfo),u){const n=window.ChatInfo?.payload||{};let s={};const a=Object.keys(localStorage).filter(i=>i.startsWith("voiceflow-session-"));if(a.length>0){const i=localStorage.getItem(a[0]);if(i)try{s=JSON.parse(i)}catch(r){console.warn("Failed to parse voiceflow localStorage:",r)}}window.chatContext={...n,...s},console.log("âœ… window.chatContext created:",window.chatContext)}u?console.log("ğŸµ AUDIO MODE: Scripts will be loaded via PHP footer"):(console.log("ğŸ”„ COMPONENT MOUNT: Initializing Voiceflow..."),console.log("ğŸ‘¤ User:",c?.name,c?.id),console.log("ğŸ“ Current Session ID:",D),se())},[c,u]);const E=async(o,t)=>{try{console.log(`ğŸ“¡ Making API call to ${o} with data:`,t);const l=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify(t)});console.log(`ğŸ“¡ Response status: ${l.status} ${l.statusText}`),console.log("ğŸ“¡ Response headers:",Object.fromEntries(l.headers.entries()));const n=await l.text();console.log("ğŸ“¡ Raw response:",n.substring(0,200)+(n.length>200?"...":""));let s;try{s=JSON.parse(n),console.log("ğŸ“¡ Parsed JSON result:",s)}catch(a){return console.error("âŒ Failed to parse response as JSON:",a),console.log("âŒ Response was:",n),{error:"Invalid JSON response",raw_response:n}}return s.error==="Unauthenticated"&&console.warn(`ğŸ”’ Authentication required for ${o}. User may need to log in again.`),s}catch(l){return console.error(`âŒ API call to ${o} failed:`,l),{error:"Network error",details:l}}},x=()=>{try{const o=Object.keys(localStorage).filter(t=>t.startsWith("voiceflow-session-"));if(o.length===0){N(null);return}for(const t of o){const l=localStorage.getItem(t);if(l)try{const s=JSON.parse(l).userID;if(s&&d[s]){N(s),console.log(`ğŸ¯ Current active session identified: ${s} from localStorage key: ${t}`);return}}catch(n){console.warn(`âš ï¸ Could not parse localStorage session ${t}:`,n);continue}}N(null)}catch(o){console.error("âŒ Error identifying current active session:",o),N(null)}},y=async(o,t)=>{const l=o.replace("voiceflow-session-","");try{console.log(`ğŸ” Monitoring localStorage key: ${o}`),console.log("ğŸ“¦ Raw localStorage value:",t.substring(0,200)+"...");let n;try{n=JSON.parse(t)}catch(i){console.error(`âŒ Failed to parse localStorage JSON for ${o}:`,i);return}const s=n.userID;if(console.log("ğŸ¯ Session Analysis:",{localStorage_key:o,project_id:l,session_userID:s,status:n.status,turns_count:n.turns?.length||0}),!s){console.warn("âš ï¸ No userID found in localStorage value. Available keys:",Object.keys(n)),console.warn("âš ï¸ Cannot process session without userID - skipping");return}console.log(`ğŸ” ğŸ” CHECKING: Does session with userID "${s}" exist in database?`);const a=await E("/api/sessions/check",{project_id:l,voiceflow_user_id:s});if(a&&a.error){a.error==="Unauthenticated"?console.warn(`ğŸ”’ âŒ CANNOT CHECK: User not authenticated - skipping session "${s}"`):a.error==="Invalid JSON response"?console.error("ğŸš¨ âŒ API ERROR: Returning HTML instead of JSON - check routes/middleware"):console.error(`âŒ API ERROR: Failed to check session "${s}":`,a.error);return}if(a&&a.exists){console.log(`âœ… âœ… SESSION EXISTS: Found userID "${s}" in database`),console.log("ğŸ”„ ğŸ”„ UPDATING: Syncing current localStorage value to existing session...");const i=await E("/api/sessions/update",{project_id:l,session_data:{last_turn:n,source:"localStorage_sync"}});i?.success?(console.log(`âœ… âœ… UPDATE SUCCESS: Session "${s}" updated with latest localStorage data`),console.log(`ğŸ“Š Updated session now has ${n.turns?.length||0} messages`)):i?.error&&console.error(`âŒ âŒ UPDATE FAILED: Could not update session "${s}":`,i.error)}else{console.log(`ğŸ†• ğŸ†• NEW SESSION DETECTED: userID "${s}" NOT found in database`),console.log("ğŸ“ ğŸ“ REGISTERING: Creating new session record..."),console.log(`ğŸ¯ Using pending session name: "${f}"`),console.log(`ğŸ¯ Registration triggered from: ${new Error().stack?.split(`
`)[1]?.trim()}`);const i={project_id:l,session_data:{last_turn:n,source:"localStorage_sync",detected_at:new Date().toISOString()},session_name:f};console.log("ğŸ“‹ Registration details:",{project_id:l,userID:s,status:n.status,message_count:n.turns?.length||0});const r=await E("/api/sessions/register",i);r?.success?(console.log(`âœ… âœ… REGISTRATION SUCCESS: New session "${s}" created in database`),console.log("ğŸ‰ ğŸ‰ NEW SESSION ADDED: Refreshing sidebar to show the new session..."),console.log("ğŸ“Š Registered session data:",r),Z(null),console.log("ğŸ”„ Triggering sessions list refresh..."),G.reload({only:["sessions"],onSuccess:()=>{console.log("âœ… Sessions list refreshed successfully")},onError:w=>{console.error("âŒ Failed to refresh sessions list:",w)}})):r?.error&&(console.error(`âŒ âŒ REGISTRATION FAILED: Could not create session "${s}":`,r.error),console.error("âŒ Full error details:",r))}console.log(`ğŸ ğŸ SYNC COMPLETE: Finished processing session "${s}"`),console.log("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€")}catch(n){console.error("âŒ Error processing localStorage session:",n)}},V=async()=>{console.log("ğŸ” ğŸš€ ğŸš€ STARTING INITIAL LOCALSTORAGE SCAN..."),console.log("ğŸ” Scanning for keys matching pattern: voiceflow-session-*");const o=Object.keys(localStorage).filter(t=>t.startsWith("voiceflow-session-"));console.log(`ğŸ“¦ ğŸ“¦ FOUND ${o.length} VOICEFLOW SESSION KEYS:`),o.forEach((t,l)=>{console.log(`  ${l+1}. ${t}`)}),o.length===0?console.log("ğŸ“­ No Voiceflow sessions found in localStorage - monitoring for new ones..."):console.log("ğŸ”„ ğŸ”„ PROCESSING EACH SESSION: Checking database and syncing...");for(let t=0;t<o.length;t++){const l=o[t],n=localStorage.getItem(l);console.log(`
ğŸ”„ [${t+1}/${o.length}] PROCESSING: ${l}`),n?await y(l,n):console.warn(`âš ï¸ âš ï¸ WARNING: Key ${l} has no value - skipping`)}console.log(`
âœ… âœ… INITIAL SCAN COMPLETE: Processed ${o.length} sessions`),console.log("ğŸ§ ğŸ§ MONITORING ACTIVE: Watching for localStorage changes..."),console.log("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")};g.useEffect(()=>{V()},[]),g.useEffect(()=>{d&&Object.keys(d).length>0&&x()},[d]),g.useEffect(()=>{if(T)return;console.log("ğŸ§ Setting up CONTINUOUS localStorage monitoring...");const o=async s=>{s.key?.startsWith("voiceflow-session-")&&(console.log("ğŸ”„ ğŸ”„ LOCALSTORAGE CHANGE DETECTED!"),console.log(`ğŸ“ Key: ${s.key}`),console.log(`ğŸ“¦ New value length: ${s.newValue?.length||0} characters`),console.log("ğŸš€ ğŸš€ TRIGGERING SYNC: Processing localStorage change..."),s.newValue?(console.log(`ğŸ“‹ PROCESSING: localStorage change for ${s.key}`),await y(s.key,s.newValue),x()):(console.log(`ğŸ—‘ï¸ VALUE REMOVED: localStorage key ${s.key} was deleted (not processing)`),x()))};window.addEventListener("storage",o);const t=localStorage.setItem;localStorage.setItem=function(s,a){const i=new CustomEvent("localStorageChange",{detail:{key:s,newValue:a,oldValue:localStorage.getItem(s)}});t.apply(this,[s,a]),window.dispatchEvent(i)};const l=s=>{const{key:a,newValue:i}=s.detail;a?.startsWith("voiceflow-session-")&&(i&&y(a,i),x())};window.addEventListener("localStorageChange",l);const n=setInterval(()=>{console.log("ğŸ” Polling for new localStorage sessions..."),Object.keys(localStorage).filter(a=>a.startsWith("voiceflow-session-")).forEach(a=>{const i=localStorage.getItem(a);if(i)try{const w=JSON.parse(i).userID;w&&!d[w]&&(console.log(`ğŸ†• NEW SESSION DETECTED via polling: ${a} with userID: ${w}`),y(a,i),x())}catch(r){console.warn(`âš ï¸ Could not parse session during polling: ${a}`,r)}})},2e3);return Y(!0),console.log("âœ… localStorage listeners and polling set up successfully"),()=>{window.removeEventListener("storage",o),window.removeEventListener("localStorageChange",l),clearInterval(n),localStorage.setItem=t}},[T]),g.useEffect(()=>(console.log("ğŸ—³ï¸ Setting up window.chatActions..."),window.chatActions={upVote:o=>{console.log("ğŸ‘ Message upvoted:",o.substring(0,100)+"...")},downVote:o=>{console.log("ğŸ‘ Message downvoted:",o.substring(0,100)+"...")}},console.log("âœ… window.chatActions set up successfully"),()=>{delete window.chatActions}),[]);const F=o=>{try{return new Date(o).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})}catch{return"Unknown"}},te=(o,t)=>{console.log(`ğŸ”„ SWITCHING TO SESSION: ${o}`),console.log("ğŸ“Š Session data:",t);try{A(!1),console.log("ğŸ§¹ CLEARING: Removing all voiceflow-session-* from localStorage"),Object.keys(localStorage).filter(r=>r.startsWith("voiceflow-session-")).forEach(r=>{console.log(`ğŸ—‘ï¸ Removing: ${r}`),localStorage.removeItem(r)});const s=`voiceflow-session-${t.project_id||"686331bc96acfa1dd62f6fd5"}`,a=t.value||{};console.log(`ğŸ“ CREATING: New localStorage entry ${s}`),console.log("ğŸ“¦ Session value data:",a),localStorage.setItem(s,JSON.stringify(a)),q(o);const i=`/sessions/${o}`;console.log(`ğŸ§­ NAVIGATING: To ${i} (full page reload)`),window.location.href=i}catch(l){console.error("âŒ Error switching sessions:",l)}},ne=async()=>{if(!p||!m){console.error("Missing feedback rating or active session ID");return}L(!0);try{console.log("ğŸ“ Submitting feedback",{session_id:m,rating:p,comment:O});const o=await E("/api/sessions/feedback",{session_id:m,rating:p,comment:O.trim()||null});o?.success?(console.log("âœ… Feedback submitted successfully"),v(!1),j(null),k(""),alert("Thank you for your feedback!")):(console.error("âŒ Feedback submission failed:",o),alert("Failed to submit feedback. Please try again."))}catch(o){console.error("âŒ Error submitting feedback:",o),alert("An error occurred while submitting feedback.")}finally{L(!1)}},W=()=>{if(!m){console.warn("No active session to provide feedback for");return}console.log("ğŸ‘ Thumbs up clicked for session:",m),j("positive"),v(!0)},U=()=>{if(!m){console.warn("No active session to provide feedback for");return}console.log("ğŸ‘ Thumbs down clicked for session:",m),j("negative"),v(!0)},P=()=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex-1 overflow-y-auto no-scrollbar",children:Object.keys(d).length===0?e.jsx("div",{className:"h-full flex flex-col items-center justify-center p-4 md:p-6 text-center",children:e.jsxs("div",{className:"flex flex-col items-center space-y-3 md:space-y-4",children:[e.jsx("div",{className:"p-4 md:p-6 bg-gray-50 rounded-full",children:e.jsx(S,{className:"h-8 md:h-10 w-8 md:w-10 text-gray-300"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold text-gray-700",children:"No active sessions yet"}),e.jsx("p",{className:"text-xs md:text-sm text-gray-500 max-w-sm",children:"Start a conversation in the chat area to begin your coaching journey and create your first session."})]}),e.jsx("div",{className:"flex items-center space-x-2 text-xs text-gray-400 mt-4 md:mt-6",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),e.jsx("span",{children:"Ready to chat"})]})})]})}):e.jsx("div",{className:"p-2 md:p-4 space-y-2 md:space-y-3",children:Object.entries(d).map(([o,t])=>e.jsxs("div",{className:`p-2 md:p-3 rounded-lg border cursor-pointer transition-colors ${m===o?"bg-green-50 border-green-300 shadow-sm ring-2 ring-green-200":B===o?"bg-blue-50 border-blue-200":"bg-white hover:bg-gray-50"}`,onClick:()=>te(o,t),children:[e.jsx("div",{className:"flex items-start justify-between mb-1 md:mb-2",children:e.jsxs("div",{className:"font-medium text-xs md:text-sm truncate flex-1",children:[t.name||`Session ${o.substring(o.length-8)}`,m===o&&e.jsx("span",{className:"ml-2 text-[10px] md:text-xs bg-green-500 text-white px-1.5 md:px-2 py-0.5 rounded-full",children:"Current"})]})}),e.jsxs("div",{className:"flex items-center gap-1.5 md:gap-2 text-[10px] md:text-xs text-gray-500",children:[e.jsx(Ce,{className:"h-2.5 md:h-3 w-2.5 md:w-3"}),e.jsx("span",{children:F(t.created_at)})]}),e.jsxs("div",{className:"flex items-center gap-1.5 md:gap-2 text-[10px] md:text-xs text-gray-500 mt-0.5 md:mt-1",children:[e.jsx(Ee,{className:"h-2.5 md:h-3 w-2.5 md:w-3"}),e.jsxs("span",{children:["Updated ",F(t.updated_at)]})]}),e.jsxs("div",{className:"flex items-center gap-1.5 md:gap-2 text-[10px] md:text-xs text-gray-400 mt-0.5 md:mt-1",children:[e.jsx(S,{className:"h-2.5 md:h-3 w-2.5 md:w-3"}),e.jsxs("span",{children:[t.value?.turns?.length||0," messages"]})]})]},o))})})});return e.jsxs(ie,{children:[e.jsx(ae,{title:"Sessions",children:e.jsx("script",{src:"/localStorage.js",defer:!0})}),e.jsxs("div",{className:"flex flex-col md:flex-row h-[calc(100vh-4rem)] md:h-[calc(100vh-8rem)] gap-3 md:gap-6 pt-3 md:pt-6",children:[e.jsx("div",{className:"hidden md:flex w-80 flex-shrink-0",children:e.jsxs(M,{className:"h-full w-80 lg:w-full flex flex-col gap-1 py-0 pt-6",children:[e.jsxs(ve,{className:"flex-shrink-0",children:[e.jsxs(ye,{className:"flex items-center gap-2",children:[e.jsx(S,{className:"h-5 w-5"}),"Your Sessions"]}),e.jsxs(be,{children:[Object.keys(d).length," active session",Object.keys(d).length!==1?"s":""]})]}),e.jsx(H,{className:"p-0 flex-1 flex flex-col min-h-0",children:e.jsx(P,{})})]})}),e.jsxs(re,{open:Q,onOpenChange:A,children:[e.jsx(ce,{asChild:!0,children:e.jsx(h,{variant:"outline",size:"icon",className:"md:hidden fixed z-50 h-11 w-11 bg-white",style:{top:"8px",left:"10%"},children:e.jsx(ke,{className:"h-5 w-5"})})}),e.jsxs(de,{side:"left",className:"w-80 p-0",children:[e.jsxs(ge,{className:"p-6 pb-4",children:[e.jsxs(me,{className:"flex items-center gap-2",children:[e.jsx(S,{className:"h-5 w-5"}),"Your Sessions"]}),e.jsxs(he,{children:[Object.keys(d).length," active session",Object.keys(d).length!==1?"s":""]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx(P,{})})]})]}),e.jsx("div",{className:"flex-1",children:e.jsx(M,{className:"h-full py-0",children:e.jsx(H,{className:"p-0 h-full",children:u?e.jsxs("div",{className:"h-full w-full rounded-lg overflow-hidden flex flex-col relative",children:[e.jsxs("div",{className:"flex items-center p-3 md:p-4 bg-white",children:[e.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[e.jsx(h,{variant:"ghost",size:"sm",className:"h-9 w-9 md:h-8 md:w-8 p-0 hover:bg-blue-50 hover:text-blue-600 touch-manipulation",onClick:()=>{console.log("ğŸ’¬ Switch to text chat");const o=new URL(window.location.href);o.searchParams.delete("mode"),window.location.href=o.toString()},children:e.jsx(S,{className:"h-4 w-4 md:h-4 md:w-4"})}),e.jsx("div",{className:"w-px h-4 md:h-5 bg-gray-300"}),e.jsx("h2",{className:"text-sm md:text-lg font-semibold text-gray-900 truncate max-w-[140px] sm:max-w-[200px] md:max-w-none",children:b?.name||f||"Audio Session"})]}),e.jsxs("div",{className:"flex items-center gap-1.5 md:gap-2 ml-auto",children:[e.jsx(h,{variant:"ghost",size:"sm",className:"h-9 w-9 md:h-8 md:w-8 p-0 hover:bg-green-50 hover:text-green-600 touch-manipulation",onClick:W,children:e.jsx(z,{className:"h-4 w-4"})}),e.jsx(h,{variant:"ghost",size:"sm",className:"h-9 w-9 md:h-8 md:w-8 p-0 hover:bg-red-50 hover:text-red-600 touch-manipulation",onClick:U,children:e.jsx(K,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"flex-1 relative",children:e.jsx("elevenlabs-convai",{ref:oe,"data-test":"elevenlabs-convai","agent-id":"agent_0901k31ke64mf0w8me1gdwygb7ze",style:{display:"block",opacity:"0",position:"absolute",top:"0",left:"0",width:"100%",height:"100%",minHeight:"400px",border:"none",borderRadius:"0 0 8px 8px",transition:"opacity 0.5s ease-in-out"}})})]}):e.jsxs("div",{className:"h-full w-full rounded-lg overflow-hidden flex flex-col relative",children:[e.jsxs("div",{className:"flex items-center p-3 md:p-4 bg-white",children:[e.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[e.jsx(h,{variant:"ghost",size:"sm",className:"h-9 w-9 md:h-8 md:w-8 p-0 hover:bg-blue-50 hover:text-blue-600 touch-manipulation",onClick:()=>{console.log("ğŸ™ï¸ Switch to audio mode");const o=new URL(window.location.href);o.searchParams.set("mode","audio"),window.location.href=o.toString()},children:e.jsx(je,{className:"h-4 w-4"})}),e.jsx("div",{className:"w-px h-4 md:h-5 bg-gray-300"}),e.jsx("h2",{className:"text-sm md:text-lg font-semibold text-gray-900 truncate max-w-[140px] sm:max-w-[200px] md:max-w-none",children:b?.name||f||"Text Chat"})]}),e.jsxs("div",{className:"flex items-center gap-1.5 md:gap-2 ml-auto",children:[e.jsx(h,{variant:"ghost",size:"sm",className:"h-9 w-9 md:h-8 md:w-8 p-0 hover:bg-green-50 hover:text-green-600 touch-manipulation",onClick:W,children:e.jsx(z,{className:"h-4 w-4"})}),e.jsx(h,{variant:"ghost",size:"sm",className:"h-9 w-9 md:h-8 md:w-8 p-0 hover:bg-red-50 hover:text-red-600 touch-manipulation",onClick:U,children:e.jsx(K,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"flex-1 relative",children:e.jsx("div",{id:"main-voiceflow-chat",className:"absolute inset-0",children:e.jsx("div",{className:"flex items-center justify-center h-full bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx(S,{className:"h-8 w-8 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-gray-500",children:"Loading chat interface..."})]})})})})]})})})})]}),e.jsx(ue,{open:ee,onOpenChange:v,children:e.jsxs(fe,{className:"max-w-[95vw] sm:max-w-[425px]",children:[e.jsxs(pe,{children:[e.jsx(we,{className:"text-base md:text-lg",children:p==="positive"?"ğŸ‘ Share your positive feedback":"ğŸ‘ Help us improve"}),e.jsx(xe,{className:"text-xs md:text-sm",children:p==="positive"?"We'd love to hear what you enjoyed about this session!":"Let us know what went wrong so we can improve your experience."})]}),e.jsx("div",{className:"space-y-3 md:space-y-4",children:e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"feedback-comment",className:"text-xs md:text-sm font-medium",children:[p==="positive"?"What did you like?":"What can we improve?"," ","(optional)"]}),e.jsx(Te,{id:"feedback-comment",placeholder:p==="positive"?"Tell us what worked well...":"Tell us what didn't work or what you expected...",value:O,onChange:o=>k(o.target.value),className:"mt-2 text-sm",rows:3})]})}),e.jsxs(Se,{children:[e.jsx(h,{variant:"outline",onClick:()=>{v(!1),j(null),k("")},disabled:_,children:"Cancel"}),e.jsx(h,{onClick:ne,disabled:_,className:p==="positive"?"bg-green-600 hover:bg-green-700":"bg-blue-600 hover:bg-blue-700",children:_?"Submitting...":"Submit Feedback"})]})]})})]})}export{He as default};
